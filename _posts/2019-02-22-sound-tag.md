---
layout: post
title: Sound Tag
date:  2019-02-25
last_modified_at: 2019-02-25
project_date: 201508
summary: 녹음된 내용의 단어의 위치를 검색하는 앱
categories: posts
---

# Sound Tag

## 개요

- 두명에서 2015 국어정보처리 경진대회에 참가하면서 만든 앱.
- 수업을 들으면 녹음을 해둘 때가 있는데 내용이 길어질수록 원하는 부분을 찾기 힘듦
- 녹음된 내용에서 원하는 부분을 검색 할 수 있으면 좋겠다 싶어서 만들어보게 되었음.
- 소스코드는 없네요..

## 기술 스택

- Android
- Node.js / Express

## 개발 내용 (안드로이드)

### 음원의 TEXT로 변환 (STT)

- **목적**
  - 검색을 위해서는 먼저 텍스트로 변환하는 것이 필요해보였음.
  - 구글의 STT[^1] REST API를 사용하여 음성을 텍스트로 변환.
    
- **문제점**
  - 조금만 길게 녹음된 내용을 STT로 변환하려고 하면 인식이 안되는 문제가 있음.

- **해결방안**
  - 큐 자료구조를 이용해 보기로 함. 약 5초의 interval을 사용  
  ![stt-queue](/images/soundtag-stt-queue.png)

- **결과**
  - 음성 데이터를 나눠 보내니 인식이 되었음.
  - 변환된 TEXT 내용은 start_time:end_time:text_length/text 의 형식으로 저장됨. 

- **아쉬운 점**
  - 음성을 어느 기준 없이 일정히 자르다보니 글의 중간 중간이 부자연스러운 부분이 있음. 
  - 기존에 가지고 있는 녹음 음성에서 변환 기능의 부재.

### 녹음기 기능 개발

- **목적**
  - 음성을 녹음할 수 있는 기능 제공.
  - STT API에서 필요한 대로 PCM 포맷으로 녹음
    
- **결과**  
  - 녹음전(왼쪽), 녹음중(오른쪽)  
  ![soundtag-record](/images/soundtag-record.png)

- **아쉬운 점**
  - PCM wav 는 무손실이라 용량이 크므로 다른 포맷으로 변경하여 저장하는게 더 좋을 것 같음.
  - 원하는 제목으로 저장하는 기능이 없음. 임의의 제목으로 저장됨.

### 원하는 부분 찾아가는 기능

- **목적**
  - 검색한 단어가 있는 위치를 찾아가 재생하는 기능

- **문제점**
  - 검색된 단어의 위치는 전체 텍스트에서 위치 index로 반환 됨.
  - index의 위치로 어떻게 전체 음성에서의 위치를 추측할 것인가 고민

- **해결방안**
  - 단순히 검색된 index의 위치를 전체 음성의 비율에 대조  
  ex) length==100 index==50 일 때, 전체 녹음 시간이 10초라면 5초의 위치에서 재생.
   
- **결과**  
  - 단어 검색 후 결과(왼쪽), 검색된 위치 재생(오른쪽)  
  ![soundtag-search](/images/soundtag-search.png)

- **아쉬운 점**
  - 텍스트 파일에 5초마다 start time, end time, length 모두 저장하는 만큼 time 데이터를 이용해서 추적하면 좀 더 정확한 위치를 판단할 수 있었을 것이라고 생각됨.

## 개발 내용 (서버, Node.js/Express)
### 빈출 단어 Top3 추출 기능 

- **목적**
  - 텍스트에서 빈출 단어를 제공하므로써 내용의 중점 파악하는데 참고할 수 있음.

- **문제점**
  - 인코딩의 문제로 형태소 분석이 안되었음.

- **해결방안**
  - iconv를 이용해서 인코딩 후 단어를 추출.
    
- **결과**  
  - 연구실의 형태소 분석기 사용해서 단어를 추출.
  - 추출된 단어 빈도수 계산  
  ![soundtag-word-frequency](/images/soundtag-word-frequency.png)

- **아쉬운 점**
  - 단순히 단어를 추출해주기 보다는 아래처럼 그래픽으로 볼 수 있도록 페이지를 제공한다던가 하는 것이 더  좋았을 것 같음. 
  ![soundtag-word-cloud](/images/soundtag-word-cloud.png){:width="80%"}

## Footnotes

[^1]: STT: Speech To Text. 음성 데이터를 텍스트 데이터로 변환하는 것
